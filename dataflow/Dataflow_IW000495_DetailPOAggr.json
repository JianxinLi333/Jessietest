{
	"name": "Dataflow_IW000495_DetailPOAggr",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "sourceIW000495DetailPO"
				}
			],
			"sinks": [
				{
					"name": "sinkIW000495DetailPOAggr"
				}
			],
			"transformations": [
				{
					"name": "aggregate1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "sort1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ID as string,",
				"          MainID as string,",
				"          PONumber as string,",
				"          POReceivedDate as timestamp,",
				"          POValue as decimal(18,2),",
				"          CreatedBy as string,",
				"          CreatedByName as string,",
				"          CreatedDate as timestamp,",
				"          POFile as string,",
				"          FileExt as string,",
				"          FilePath as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false) ~> sourceIW000495DetailPO",
				"sort1 aggregate(groupBy(MainID),",
				"     PONumber = collect(PONumber),",
				"          POReceivedDate = collect(POReceivedDate),",
				"          CreatedDate = collect(CreatedDate)) ~> aggregate1",
				"aggregate1 derive(MainID = lower(MainID),",
				"          PONumber = toString(PONumber),",
				"          POReceivedDate = replace(toString(at(sort(mapIndex(POReceivedDate,toDate(#item)),compare(#item1, #item2)),1)),\"1900-01-01\",\"\"),",
				"          CreatedDate = replace(toString(at(sort(mapIndex(CreatedDate,toDate(#item)),compare(#item1, #item2)),1)),\"1900-01-01\",\"\"),",
				"          POReceivedDateList = replace(replace(replace(replace(toString(mapIndex(POReceivedDate,toDate(#item))),\"[\\\"\",\"\"),\"\\\"]\",\"\"),\"\\\",\\\"\",\";\"),\"1900-01-01\",\"\"),",
				"          CreatedDateList = replace(replace(replace(replace(toString(mapIndex(CreatedDate,toDate(#item))),\"[\\\"\",\"\"),\"\\\"]\",\"\"),\"\\\",\\\"\",\";\"),\"1900-01-01\",\"\")) ~> derivedColumn1",
				"sourceIW000495DetailPO sort(asc(CreatedDate, true)) ~> sort1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     truncate: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     format: 'table') ~> sinkIW000495DetailPOAggr"
			]
		}
	}
}